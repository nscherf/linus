<!DOCTYPE html>
<html lang="en">
	<head>
		<title>Data viewer</title>
        <meta charset="utf-8">
        <meta http-equiv="origin-trial" content="Ai1/G787sugfmWtk1xQExa8N6OqwDsJyNn+OwpA1J4PozR1lixRYIQ4Tmp00vrGWS8FQQ2iDyqjwaewrOfYvPAUAAABTeyJvcmlnaW4iOiJodHRwczovL3RocmVlanMub3JnOjQ0MyIsImZlYXR1cmUiOiJXZWJYUkRldmljZU03NiIsImV4cGlyeSI6MTU2ODAyMzQ3OH0=">
        <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
        <script src="includes/pako.js"></script>
        <script src="includes/build/three.js"></script>
		<script src="includes/examples/js/controls/OrbitControls.js?2"></script>
		<script src="includes/examples/js/controls/TrackballControls.js?2"></script>
		<script src="includes/examples/js/libs/stats.min.js"></script>
        <script src="includes/examples/js/WebGL.js"></script>
        <script src="includes/examples/jsm/vr/WebVR.js"></script>
        <script src="includes/sortable.js"></script>
        <script src="includes/jszip.min.js"></script>
        <script src="includes/FileSaver.min.js"></script>
        <script src="includes/qrcode.min.js"></script>

        <link href="layout/style.css?14" rel="stylesheet" type="text/css"> <!-- "?x" is used to force new download -->
        <link rel="apple-touch-icon" sizes="57x57" href="layout/icon/apple-icon-57x57.png">
        <link rel="apple-touch-icon" sizes="60x60" href="layout/icon/apple-icon-60x60.png">
        <link rel="apple-touch-icon" sizes="72x72" href="layout/icon/apple-icon-72x72.png">
        <link rel="apple-touch-icon" sizes="76x76" href="layout/icon/apple-icon-76x76.png">
        <link rel="apple-touch-icon" sizes="114x114" href="layout/icon/apple-icon-114x114.png">
        <link rel="apple-touch-icon" sizes="120x120" href="layout/icon/apple-icon-120x120.png">
        <link rel="apple-touch-icon" sizes="144x144" href="layout/icon/apple-icon-144x144.png">
        <link rel="apple-touch-icon" sizes="152x152" href="layout/icon/apple-icon-152x152.png">
        <link rel="apple-touch-icon" sizes="180x180" href="layout/icon/apple-icon-180x180.png">
        <link rel="icon" type="image/png" sizes="192x192"  href="layout/icon/android-icon-192x192.png">
        <link rel="icon" type="image/png" sizes="32x32" href="layout/icon/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="96x96" href="layout/icon/favicon-96x96.png">
        <link rel="icon" type="image/png" sizes="16x16" href="layout/icon/favicon-16x16.png">
        <link rel="manifest" href="layout/icon/manifest.json">
        <meta name="msapplication-TileColor" content="#ffffff">
        <meta name="msapplication-TileImage" content="layout/icon/ms-icon-144x144.png">
        <meta name="theme-color" content="#ffffff">
        <meta name="viewport" content="width=600, user-scalable=no">
	</head>
    
	<body>
        <script src="includes/HelioWebXRPolyfill.js"></script>

        <!-- The loading screen. This item is created first and will be hidden after loading. -->
        <div id="loadingBox">
            <div id="loadingBar">
                <div id="loadingBarInner">&nbsp;</div>
                <div id="loadingBarText"><img id="loadingBarImage" src="layout/loading.gif">  &nbsp;&nbsp;&nbsp; Loading...</div>
            </div>
        </div>

        <!-- Include the JSON containing the data. Large file! -->
        <script>console.time('time to load data');</script>
        <script src='data/data.json?temp7'></script>
        <script>console.timeEnd('time to load data');</script>

        <!-- Include the remaining components of the vis tool -->
        <script  src="DataVis.js?1"></script>
        <script  src="DataVisGui.js?1"></script>
        <script  src="DataVisTourController.js?1"></script>
        <script  src="DataVisTourEditor.js?1"></script>
        <script>

            // Create a regular GUI (builds HTML GUI)
            var gui = new DataVisGUI();
            
            // Create the vis tool, using the GUI
            var datavis = new DataVis(gui); 

            var url = new URL(window.location.href);
            
            // Now set data and parameters. Must be done first in order to prepare geometry etc.
            datavis.setData(data);
            datavis.setAA((url.searchParams.get("aa") !== null));
            datavis.showFps((url.searchParams.get("fps") !== null));
            datavis.disableGUI((url.searchParams.get("nogui") !== null));
            datavis.setLOD(url.searchParams.get("lod") ? url.searchParams.get("lod") : 1);
            datavis.setVr((url.searchParams.get("vr") !== null));
            
            // TODO: avoid this (doesn't look to nice)
            onmousedown = datavis.onmousedown.bind(datavis);
            onmousemove = datavis.onmousemove.bind(datavis);
            onmouseup = datavis.onmouseup.bind(datavis);
            ondblclick = datavis.ondblclick.bind(datavis);

            // Now let the program do everything (prepare geometry etc.)
            datavis.start();

            // The tour module, manipulating GUI and the vis tool (e.g. camera)
            var tours = new DataVisTourController(datavis, gui); 

            // Get settings first, then create the controller module
            if(url.searchParams.get("editor") !== null) tours.showTourEditor();
            if(url.searchParams.get("tour") !== null) tours.addTour("default tour", url.searchParams.get("tour"));

            /*--------------- INCLUDE CODE FOR TOURS AFTER THIS ---------------*/
                // var generatedUrlString = "http..."
                // var urlObject = new URL(generatedUrlString)
                // tours.addTour("my second tour", urlObject.searchParams.get("tour"));
                // ...and more
            /*--------------- INCLUDE CODE FOR TOURS BEFORE THIS ---------------*/
            tours.create();

            // If we want to, we can now auto-start a certain tour. E.g. if "&autoStartTour=[tourName]" is in URL
            if(url.searchParams.get("autoStartTour")!== null) {
                var tourToStart = url.searchParams.get("autoStartTour");
                if(tourToStart === "") tourToStart = "default tour";
                tours.startTour(tourToStart);
            }
           
        </script>
	</body>
</html>